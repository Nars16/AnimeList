{% extends "layout.html" %}
{% block title %}List{% endblock %}
{% block stylesheet %}
<link rel="stylesheet" href="/static/list.css">
{% endblock %}

{% block content %}

<h1>List</h1>
<a {% if status=="All" %} class="selected" {% endif %} href="/list">All</a>
<a {% if status=="Completed" %} class="selected" {% endif %} href="/list?status=Completed">Completed</a>
<a {% if status=="Watching" %} class="selected" {% endif %} href="/list?status=Watching">Watching</a>
<a {% if status=="On-Hold" %} class="selected" {% endif %} href="/list?status=On-Hold">On-Hold</a>
<a {% if status=="Dropped" %} class="selected" {% endif %} href="/list?status=Dropped">Dropped</a>
<a {% if status=="Plan to Watch" %} class="selected" {% endif %} href="/list?status=Plan%20to%20Watch">Plan to Watch</a>
<br />
<br />

{% if list_data | length > 0 %}
<form method="POST">
    <input type="submit" value="Submit changes" />

    <table>
        <tr>
            <th class="a"></th>
            <th class="b">Title</th>
            <th class="c">Progress</th>
            <th class="d">Status</th>
            <th class="e">Score</th>
            <th class="f">Remove</th>
        </tr>
        {% for anime in list_data %}
        <tr>
            <td class="a">
                {% if anime.thumbnail %}
                <img src="{{anime.thumbnail}}" width=50 height=70>
                {% else %}
                <img src="https://cdn.myanimelist.net/images/qm_50.gif" width=50 height=70>
                {% endif %}
            </td>
            <td class="b">
                <a href="/anime/{{anime.id}}">{{anime.title}}</a>
            </td>
            <td class="c">
                <input style="width:35px" type="number" name="episodes_watched_{{anime.id}}"
                    value={{anime.episodes_watched}} min="0" max="{{anime.episodes}}">
                / {{anime.episodes}}
            </td>
            <td class="d">
                <select name="status_{{anime.id}}">
                    <option value="Completed" {% if anime.status=="Completed" %} selected {% endif %}>
                        Completed
                    </option>
                    <option value="Watching" {% if anime.status=="Watching" %} selected {% endif %}>
                        Watching
                    </option>
                    <option value="On-Hold" {% if anime.status=="On-Hold" %} selected {% endif %}>
                        On-Hold
                    </option>
                    <option value="Dropped" {% if anime.status=="Dropped" %} selected {% endif %}>
                        Dropped
                    </option>
                    <option value="Plan to Watch" {% if anime.status=="Plan to Watch" %} selected {% endif %}>
                        Plan to Watch
                    </option>
                </select>
            </td>
            <td class="e">
                <select name="score_{{anime.id}}">
                    <option value="None" {% if not anime.score %} selected {% endif %}></option>
                    <option value="10" {% if anime.score==10 %} selected {% endif %}>10</option>
                    <option value="9" {% if anime.score==9 %} selected {% endif %}>9</option>
                    <option value="8" {% if anime.score==8 %} selected {% endif %}>8</option>
                    <option value="7" {% if anime.score==7 %} selected {% endif %}>7</option>
                    <option value="6" {% if anime.score==6 %} selected {% endif %}>6</option>
                    <option value="5" {% if anime.score==5 %} selected {% endif %}>5</option>
                    <option value="4" {% if anime.score==4 %} selected {% endif %}>4</option>
                    <option value="3" {% if anime.score==3 %} selected {% endif %}>3</option>
                    <option value="2" {% if anime.score==2 %} selected {% endif %}>2</option>
                    <option value="1" {% if anime.score==1 %} selected {% endif %}>1</option>
                </select>
            </td>
            <td class="f">
                <div style="text-align:center">
                    <input type="checkbox" name="remove_{{anime.id}}" style="width:30px; height:30px;">
                </div>
            </td>
        </tr>
        {% endfor %}
    </table>
    <br />

    <input type="hidden" name="csrf_token" value="{{session.csrf_token}}" />
    <input type="submit" value="Submit changes" />
</form>
{% elif status == 'All' %}
<p><strong>No animes in list</strong></p>
{% else %}
<p><strong>No animes in list with status {{status}}</strong></p>
{% endif %}

<hr />
<form method="POST" enctype="multipart/form-data">
    <p>Import data from myanimelist (.xml file):</p>
    <input type="file" name="mal_import" accept=".xml">
    <br />
    <input type="hidden" name="csrf_token" value="{{session.csrf_token}}" />
    <input type="submit" value="Submit file" />
</form>

{% endblock %}